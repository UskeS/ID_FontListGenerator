
<div align="center">
<p>
  <img alt="Static Badge" src="https://img.shields.io/badge/-Adobe%20InDesign-ff3366?style=flat-square">
  <img alt="Static Badge" src="https://img.shields.io/badge/license-MIT-yellow?style=flat-square&link=https%3A%2F%2Fgithub.com%2FUskeS%2FID_FontListGenerator%2Fblob%2Fmain%2FLICENCE.txt">
</p>
  <img src="src/ID_genFontList_logo.png" alt="Font List Generator Logo" height="120">
  <h3 align="center">InDesign Font List Generator</h3>
Make a list of your favorite fonts!
</div>

# 概要

Adobe InDesignを利用してフォントリストを生成するスクリプトです。事前に用意したフォントリストファイルを読み込むことで、フォーマットに合わせてフォントリストドキュメントを自動生成します。  

**デザインを進める上で、フォント選びの時間を短縮し、効率的かつ質の高い作業を支援すること**を目的としています。生成されたリストの例文に相互参照を利用しているため、テンプレートファイル上部の例文を変更・更新することで、ドキュメント全体の例文を一括で修正できます。

**動作保証バージョンはInDesign 2024（v19.x）および2025（v20.x）です**。それ以外のバージョンでもおそらく動作しますが、未検証です。

完成したドキュメントをPDFとして書き出したり、プリントアウトしたりして、フォント選びの参考にご活用ください！

# はじめに

デザインを進める過程で、フォント選び（特に和文フォント）に時間を取られることに煩わしさを感じたことが、自分好みのフォントリストを生成するスクリプトを作ろうと思ったきっかけです。  
事前に自分専用のフォントリストを持っておくことで、デザインの効率を上げ、質の良い仕事につなげられるはずです。  
そのため、**生成するフォントリストを何度もかんたんに作り直せる仕様**を目指しました。

# インストール方法

1.  GitHubリポジトリから本スクリプトを含むZIPファイルをダウンロードします。下記いずれかの方法でダウンロードしてください。
    1. リポジトリ右上の <img src="src/code_button.png" alt="codeボタン" width="70" style="vertical-align: middle;"> を押し、Download ZIPを選択します。
    ![GitHubからzipファイルのダウンロード](src/ss-download-zip.png)
    2. [Releases](https://github.com/UskeS/ID_FontListGenerator/releases)から、**Source code**を選択します。
    ![Releasesからダウンロード](src/releases.png)
2.  ダウンロードしたファイルを解凍します。
3.  解凍してできた一式のファイル群を、Adobe InDesignのスクリプトフォルダ内に保存します。
  * スクリプトフォルダの場所はOSやInDesignのバージョンによって異なります。下記は一例です
    * Macの場合：  
      `[ユーザー名]/Library/Preferences/Adobe InDesign/[InDesignのバージョン]/ja_JP/Scripts/Scripts Panel`
    * Windowsの場合：  
      `C:\Users\[ユーザー名]\AppData\Roaming\Adobe\InDesign\Version [InDesignのバージョン]-J\Scripts\Scripts Panel`

# 使い方

## 事前準備

スクリプトでフォントリストを生成するにあたり、以下の準備が必要です。

- [テンプレートファイル（zipファイル同梱）](#専用テンプレートファイル)
- [フォントリストファイル（要作成）](#フォントリストファイル)
- [フォントのインストール](#使用するフォントのインストール)

以下、順に説明します。

### 専用テンプレートファイル
* 本スクリプトを実行する前に、特定の構造を持つInDesignのドキュメント（テンプレート）を先に開いておく必要があります。基本的にはこのリポジトリに含まれるindtファイル（`フォント一覧_temp.indt`／v19 CC2024以下をご利用の場合は同名のidmlファイル）をご利用ください。  
* ご自分でテンプレートファイルを作成される場合は、後述の「[テンプレートファイルの作成](#テンプレートファイルの作成)」の項を参照してください。

### フォントリストファイル

* 生成したいフォントのリストを記述したテキストファイル（`.txt`形式）を作成します。
* 拡張子を除いたファイル名が、スクリプトで自動生成されるドキュメントの**ページタイトル名＝セクション名**になります。
  ![ファイル名がページタイトルになる](src/ss-procedure-04.png)
* ファイルの文字コードは**UTF-8**、改行コードは**LF**を推奨（CRLFでも可）。
* フォントリストの各行は **`[言語コード]\t[フォントファミリー名またはフォント名]`** の形式で記述します。
  * `[言語コード]`：`J`（日本語用）または `E`（欧文用）を行頭に記述します。
  * `\t`：タブ文字です。言語コードとフォント名の区切りに使用します。
  * `[フォントファミリー名またはフォント名]`：リストに含めたいフォントの名前を記述します。
    * 同梱の[ID_makeFontLists.jsx](./ID_makeFontLists.jsx)を使うと、選択したテキストフレームに使用されているフォントをまとめてリスト化できます。
      ![フォントリストの作成](src/readme-makeFontList.gif)
    * **例**（タブは分かりやすいように`\t`と表記しています）：
      ```text
      J\tA P-OTF 欅明朝 Oldstyle Min2
      J\tA P-OTF リュウミン Pr6N
      ```
    * 文字パネルからフォント名をコピーしてリストを作成する場合は、フォントによって末尾に余計なスペースが入っていることがあるので注意してください（その余計なスペースは削除してOKです）
  * **空の行は存在できません**
* これらのルールが守られていない場合、エラーメッセージが表示されスクリプトは終了します。

### 使用するフォントのインストール

* フォントリストファイルに記述したフォントが、スクリプトを実行する環境にインストールされており、InDesignで利用可能な状態である必要があります。
* **インストールされていないフォントや、InDesignで利用できない状態（例：破損している、フェイクフォントである）のフォント**がリストに含まれている場合、スクリプト実行中にエラーメッセージが表示され、処理が中断されます。事前にフォントが正しく利用できるか確認してください。

## スクリプトの実行：フォント一覧ドキュメントを生成する

1.  **同梱のテンプレートファイル（`フォント一覧_temp.indt`）を開きます**。  
  このindtファイルはInDesign 2025で作ってあるので、それより古いバージョンをお使いの場合は同梱のidmlファイルをお使いください。
  ドキュメントを開くと、上部に和文と欧文の例文が置いてあります。わざとページに触れるように配置してあるので、**位置は動かさないでください**。
  ![テンプレートドキュメントを開いたところ](src/ss-procedure-01.png)
1.  InDesignのスクリプトパネルから、保存した本スクリプトを選択し、実行します。
2.  スクリプト実行後に表示されるファイル選択ダイアログで、事前に作成したフォントリストファイル（`.txt`形式）を選択します。**複数のファイルをまとめて選択することも可能です**。
  ![スクリプトの実行](src/readme-fontListGenerator.gif)
1.  ファイルを選択して「開く」ボタンをクリックすると、スクリプトがフォント一覧ドキュメントの生成を開始します。
2.  指定したフォントの数によっては時間がかかる場合があります。スクリプトが完了すると、フォント一覧ドキュメントが完成します。
3.  生成されたドキュメントを確認し、必要に応じてPDFへの書き出しやプリントアウトを行います。
4.  **例文の一括編集**：生成されたリストの例文は、InDesignの相互参照機能を利用して、テンプレートファイルの一番最初のページにある例文を参照しています。例文を編集し、相互参照を更新することで、生成されたすべての例文を一度に変更できます。
  ![例文の一括編集](src/readme-changeSampleSentence.gif)

## テンプレートファイルの作成

テンプレートファイルには、スクリプトが参照する以下の名前の要素が必要です。名前を変更するとスクリプトが正常に動作しません。

* **テキストフレーム**（いずれもレイヤーパネルから確認できます）：
  * `和文サンプル`（相互参照の参照先として使用します - 和文例文用）
  * `欧文サンプル`（相互参照の参照先として使用します - 欧文例文用）
* **表スタイル**：
  * `フォントリスト`（自動生成するフォントリストの表組に使用します）
* **セルスタイル**：
  * `"01_ヘッダ"`, `"02_ウェイト一覧"`, `"03_例文 固定テキスト"`, `"04_例文"`の4つ（自動生成するフォントリストの表組に使用します）。
* **相互参照フォーマット**：
  * `_段落テキスト全体`（自動生成するフォントリストに挿入される例文の相互参照に使用します）
* **段落スタイル**：
  * `例文`（自動生成するフォントリストの表組に使用します）

## 注意事項

* 合成フォントにも対応していますが、ウェイト表記が「-」となります

# ライセンス

©2025 Uske_S (Yusuke SAEGUSA)  
本スクリプトは[MIT License](LICENCE.txt)の下で公開しています。

# コントリビューション

コントリビューションを歓迎します。バグ報告や改善提案はIssuesへ、コードの変更提案はPull Requestsへお願いします。

▼ご支援いただけると開発のモチベーションになります！

<a href="https://www.buymeacoffee.com/zy0thTFyt1" target="_blank"><img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" ></a>

# 謝辞

下記の皆さんにβテストにご協力いただきました。感謝申し上げます。（五十音順、敬称略）

- [DTP Transit](https://x.com/DTP_Transit)
- [あぢ（z-）そよ風邪](https://x.com/AJABON)
- [すも（伊達千代）](https://x.com/sumosumo1124)
- [ゆう](https://x.com/yuhyuh__)

# コンタクト

バグ報告や改善提案はIssuesへお願いします。  
使い方に関するご質問や、特注機能の追加開発のご相談などは下記へどうぞ。  

- X: [@Uske_S](https://x.com/Uske_S)  
- Bluesky: [@uskes.bsky.social](https://bsky.app/profile/uskes.bsky.social)

# 参考文献

- [shields.ioを使って技術系アイコンを量産した](https://qiita.com/s-yoshiki/items/436bbe1f7160b610b05c)  
shields.ioのアイコン表示の参考にした
- [MIT Licence（英）](https://opensource.org/license/mit)  
英語版は原文まま利用した
- [MIT Licence（日）](https://licenses.opensource.jp/MIT/MIT.html)  
日本語版参考訳はオープンソースグループ・ジャパンのものを利用した
- [InDesign ExtendScript API](https://www.indesignjs.de/extendscriptAPI/indesign-latest/)  
いつもお世話になっているInDesign用ExtendScriptのAPIオブジェクトモデル